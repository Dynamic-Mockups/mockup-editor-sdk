const o=({iframeId:o,data:t,mode:e,callback:n})=>{const r=(o,t)=>{o.forEach(((o,e)=>{const n=o.export_path,r="mockup"===t?`Mockup ${e+1}`:`Print file ${e+1}`;fetch(n).then((o=>{if(!o.ok)throw new Error(`Failed to fetch ${n}`);return o.blob()})).then((o=>{const t=document.createElement("a");t.href=window.URL.createObjectURL(o),t.download=r+"."+n.split(".").pop().toLowerCase(),t.click(),window.URL.revokeObjectURL(t.href)})).catch((o=>console.error("Error downloading the image:",o)))}))},a=document.getElementById(o);if(!a)return void console.error(`Iframe with ID '${o}' not found.`);a.src=a.src;const i=o=>{try{return new URL(o).host}catch(o){return console.error("Invalid Host URL:",o.message),""}},c=o=>{try{const t=new URL(o).hostname;return t.split(".").slice(-2).join(".")}catch(o){return console.error("Invalid Main Domain:",o.message),""}};window.addEventListener("message",(o=>{if("dmIframeReady"===o.data&&a.contentWindow&&a.contentWindow.postMessage({...t,locationHost:c(window.location.origin)||window.location.host||i(window.location.ancestorOrigins?.[0])},a.src),o.data.mockupsAndPrintFilesExport)if("download"===e){r(o.data.mockupsAndPrintFilesExport.mockupsExport,"mockup");const t=o.data.mockupsAndPrintFilesExport.printFilesExport.flatMap((o=>o.print_files));r(t,"print-file")}else"custom"===e&&"function"==typeof n&&n(o.data);if(o.data.mockupsExport&&("download"===e?r(o.data.mockupsExport,"mockup"):"custom"===e&&"function"==typeof n&&n(o.data)),o.data.printFilesExport)if("download"===e){const t=o.data.printFilesExport.flatMap((o=>o.print_files));r(t,"print-file")}else"custom"===e&&"function"==typeof n&&n(o.data)}))};export{o as initDynamicMockupsIframe};
